language: ruby
cache: bundler
addons:
  postgresql: '9.3'
  code_climate:
    repo_token: '<%= ENV["TRAVIS_TOKEN"] %>'
before_script:
- psql -c 'create database travis_ci_test;' -U postgres
- cp config/database.yml.travis config/database.yml
deploy:
  provider: heroku
  api_key:
    secure: XLE9lmmig5XRSZPIxQF7lVuDYyDeC5sabWWUkr0rQihOK5UHumURuw444eaaaHYbr8cGK+SxptOlTaO94pSvQtbvYrAzEgzSKOwRQ2sah6VePTHiww0nKVOHSIVplrJ64fJBu3I/OPaSLkkoRMWDSKU8beWJKVZvDco37YZcRmI=
  app: crime-billing-online-dev
  on:
    repo: ministryofjustice/crime-billing-online
    branch: develop
  run:
    - "rake db:migrate"
    - "rake db:seed"
