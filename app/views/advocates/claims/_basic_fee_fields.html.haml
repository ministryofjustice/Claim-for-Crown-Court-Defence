%tbody.basic-fee-group
  %tr.nested-fields
    %td
      = f.object.description
      - if f.object.description =~ /Basic fee/i
        .form-hint
          = raw t('.basic_fee_prompt_text')
    %td
      %a{name: "basic_fee_#{@basic_fee_count}_quantity"}
      = f.number_field :quantity, value: number_with_precision_or_default(f.object.quantity) , class: 'quantity', min: 0, max: 99999, maxlength: 5
      = validation_error_message(@error_presenter, "basic_fee_#{@basic_fee_count}_quantity")
    %td
      %a{name: "basic_fee_#{@basic_fee_count}_rate"}
      %div.pound-wrapper
        = f.label :rate, 'Â£', class: 'pound-sign bold-xsmall'
        = f.text_field :rate, value: number_with_precision(f.object.rate, precision: 2), class: 'rate', size: 10, maxlength: 8
      = validation_error_message(@error_presenter, "basic_fee_#{@basic_fee_count}_rate")
    %td.amount
      = number_to_currency(f.object.amount)
    %td.add-basic-fee-date-attended
      - if f.object.fee_type.has_dates_attended?
        = link_to_add_association t('.add_date_attended'), f, :dates_attended, class: 'button-secondary', data: {'association-insertion-method' => 'after', 'association-insertion-traversal' => 'closest', 'association-insertion-node' => 'tr'}

    = f.hidden_field :fee_type_id, value: f.object.fee_type_id

  = f.fields_for :dates_attended do |date_attended|
    - @basic_fee_date_attended_count += 1
    = render 'date_attended_fields', { f: date_attended, submodel_count: @basic_fee_date_attended_count, parent_model_prefix: "basic_fee_#{@basic_fee_count}" }
