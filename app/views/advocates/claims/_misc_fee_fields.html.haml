%tbody.misc-fee-group
  %tr.nested-fields
    
    %td
      %a{name: "misc_fee_#{@misc_fee_count}_fee_type"}
      = f.collection_select :fee_type_id, FeeType.misc, :id, :description, {prompt: true}, {class: 'select2', style: 'width:350px'}
      = validation_error_message(@error_presenter, "misc_fee_#{@misc_fee_count}_fee_type")
    %td
      %a{name: "misc_fee_#{@misc_fee_count}_quantity"}
      = f.number_field :quantity, class: 'quantity', min: 0, max: 999, maxlength: 3
      = validation_error_message(@error_presenter, "misc_fee_#{@misc_fee_count}_quantity")
    %td
      %a{name: "misc_fee_#{@misc_fee_count}_amount"}
      %div.pound-wrapper
        %div.pound-sign.bold-xsmall
          &pound;
        = f.text_field :amount, value: number_with_precision(f.object.amount, precision: 2), class: 'amount', size: 10, maxlength: 8
      = validation_error_message(@error_presenter, "misc_fee_#{@misc_fee_count}_amount")
    %td.add-misc-fee-date-attended
      = link_to_add_association t('.add_date_attended'), f, :dates_attended, class: 'button-secondary', data: {'association-insertion-method' => 'after', 'association-insertion-traversal' => 'closest', 'association-insertion-node' => 'tr'}
    %td.remove-misc-fee
      = link_to_remove_association t('.remove'), f, { wrapper_class: 'misc-fee-group' }

  = f.fields_for :dates_attended do |date_attended|
    = render 'date_attended_fields', f: date_attended
