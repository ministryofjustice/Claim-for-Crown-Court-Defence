.table-container.container
  %table.report
    %caption.visually-hidden
      = t('.show_count', page_count: claims.size, total: claims.total_count)
    %colgroup
      - if current_user.persona.admin?
        %col
      %col
      %col
      %col
      %col
      %col
      %col
      %col
    %thead
      %th{scope:'col'}
        = sortable 'case_number', t(".case_number")
      - if current_user.persona.admin?
        %th{scope:'col'}
          = sortable 'advocate', t(".advocate")
      - if current_user.persona.has_roles?(['advocate','litigator'])
        %th{scope:'col'}
          = t(".scheme")
      %th{scope:'col'}
        = t(".defendants")
      %th.numeric{scope:'col'}
        = sortable 'total_inc_vat', t(".total")
      %th.numeric{scope:'col'}
        = sortable 'amount_assessed', t(".assessed")
      %th{scope:'col'}
        = sortable 'state', t(".status")
      %th.numeric{scope:'col'}
        = sortable 'last_submitted_at', t(".submission_date")
      %th{scope:'col'}
        = t(".messages")
    %tbody
      - present_collection(claims).each do |claim|
        %tr{id: dom_id(claim),class: claim.state}
          %td
            = link_to (claim.case_number.blank? ? 'not-provided' : claim.case_number), external_users_claim_path(claim), class: "js-test-case-number-link"
          - if current_user.persona.admin?
            %td
              = claim.owner.name
          - if current_user.persona.has_roles?(['advocate','litigator'])
            %td
              = claim.scheme
          %td
            = claim.defendant_names
          %td.numeric
            = claim.total_inc_vat
          %td.numeric
            = claim.amount_assessed
          %td
            %span.state{class: 'state-' << claim.state.dasherize}
              = claim.state.humanize
          %td.numeric
            = claim.submitted_at
          %td.messages
            - if claim.messages.any?
              = link_to claim.has_unread_messages_for?(current_user) ? "View (#{claim.messages.count} new)" : "View" , "#{external_users_claim_path(claim, messages: true)}#messages"
            - else
              %span.none
                = t(".none")
