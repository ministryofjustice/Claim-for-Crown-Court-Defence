- if claims.none?
  %p
    = t(".no_claims_found")
- else
  .container
    = render partial: 'search_form'
    - if params[:search].present?
      = render partial: 'shared/search_summary'
    .claim-count
      %p
        = t('.show_count', total: claims.total_count)
  .table-container.container
    %table.claims-summary
      %caption
        = t('.show_count', total: claims.total_count)
      %colgroup
        - if current_user.persona.admin?
          %col
        %col
        %col
        %col
        %col
        %col
        %col
        %col
      %thead
        %th{scope:'col'}
          = sortable 'case_number', t(".case_number")
        - if current_user.persona.admin?
          %th{scope:'col'}
            = sortable 'advocate', t(".advocate")
        %th{scope:'col'}
          = t(".defendants")
        %th{scope:'col'}
          = sortable 'total_inc_vat', t(".total")
        %th{scope:'col'}
          = sortable 'amount_assessed', t(".assessed")
        %th{scope:'col'}
          = sortable 'state', t(".status")
        %th{scope:'col'}
          = sortable 'last_submitted_at', t(".submission_date")
        %th{scope:'col'}
          = t(".messages")
      %tbody
        - present_collection(claims).each do |claim|
          %tr{id: dom_id(claim),class: claim.state}
            %td
              = link_to (claim.case_number.blank? ? 'not-provided' : claim.case_number), external_users_claim_path(claim), class: "js-test-case-number-link"
            - if current_user.persona.admin?
              %td
                = claim.external_user.name
            %td
              = claim.defendant_names
            %td.numerical
              = claim.total_inc_vat
            %td.numerical
              = claim.amount_assessed
            %td
              %span.state{class: claim.state.dasherize}
                = claim.state.humanize
            %td.numerical
              = claim.submitted_at
            %td.messages
              - if claim.messages.any?
                = link_to claim.has_unread_messages_for?(current_user) ? "Messages (#{claim.messages.count})" : "Messages" , "#{external_users_claim_path(claim, messages: true)}#messages"
              - else
                %span.none
                  = t(".none")
