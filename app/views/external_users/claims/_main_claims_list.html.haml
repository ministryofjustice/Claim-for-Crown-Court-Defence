.table-container.container
  %table.report
    %caption
      %span.table-caption
        = your_claims_header
      %span.claim-count
        - if @claims.none?
          = t("shared.no_claims_found")
        - else
          = "Showing "
          #{pluralize(@claims.unscope(:order).size, 'claim')} of #{@claims.total_count}
          - if params[:search].present?
            matching "#{params[:search]}"
    %thead

      - if user_requires_scheme_column?
        %th{scope:'col'}
          = t('.type')

      %th{scope:'col'}
        = sortable 'case_number', t(".case_number")

      - if current_user.persona.admin?
        %th{scope:'col'}
          = sortable 'advocate', t(".advocate_litigator")

      %th{scope:'col'}
        = t(".defendants")

      %th.numeric{scope:'col'}
        = sortable 'total_inc_vat', t(".total")

      %th.numeric{scope:'col'}
        = sortable 'amount_assessed', t(".assessed")

      %th{scope:'col'}
        = sortable 'state', t(".status")

      %th.numeric{scope:'col'}
        = sortable 'last_submitted_at', t(".submission_date")

      %th{scope:'col'}
        = t(".messages")
    %tbody
      %tr.mobile-sort
        %td{colspan: 10}
          Sort by:
          = sortable 'case_number', t(".case_number")
          = sortable 'total_inc_vat', t(".total")
          = sortable 'amount_assessed', t(".assessed")
          = sortable 'state', t(".status")
          = sortable 'last_submitted_at', t(".submission_date")
      - present_collection(claims).each do |claim|
        %tr{id: dom_id(claim),class: claim.state}

          - if user_requires_scheme_column?
            %td{'aria-label' => t(".type")}
              = claim.pretty_type

          %td{'aria-label' => t(".case_number")}
            = link_to claim.case_number,
                      external_users_claim_path_for_state(claim),
                      class: "js-test-case-number-link",
                      'aria-label': "View #{claim.state.humanize} Claim, Case number: #{claim.case_number}"
            %div.unique-id-small
              = claim.unique_id
            %div.providers-ref
              = claim.providers_ref

          - if current_user.persona.admin?
            %td{'aria-label' => t(".advocate_litigator")}
              = claim.external_user.name

          %td{'aria-label' => t(".defendants")}
            = claim.defendant_names

          %td.numeric.claimed-amount{'aria-label' => t(".total")}
            = claim.total_inc_vat

          %td.numeric{'aria-label' => t(".assessed")}
            = claim.amount_assessed

          %td{scope: 'row', 'aria-label' => t(".status")}
            %span.state{class: 'state-' << claim.state.dasherize}
              = claim.state.humanize

          %td.numeric{'aria-label' => t(".submission_date")}
            = claim.submitted_at.blank? ? "-" : claim.submitted_at

          %td.messages{'aria-label' => t(".messages")}
            - if claim.messages.any?
              = link_to claim.has_unread_messages_for?(current_user) ? "View (#{claim.unread_messages_for(current_user).count} new)" : "View" , "#{external_users_claim_path(claim, messages: true)}#messages",
                        'aria-label': "View Messages for Case number #{claim.case_number}"
            - else
              %span.none= t(".none")
