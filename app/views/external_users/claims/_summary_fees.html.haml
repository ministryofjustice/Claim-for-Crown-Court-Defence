%h3.heading-medium
  = header ? header : t('common.fees')

%table{class:'table-summary', summary: t('.summary')}
  %caption
    %span.table-caption.visuallyhidden
      = t('.caption')
  %tbody
    - collection = collection ? collection : claim.fees.select(&:present?)
    - present_collection(collection.sort_by(&:position)).each do |fee|
      %tr
        %th.summary-headings{ scope: 'row'}
          = t('shared.summary.fee_category')
        %td
          = fee.fee_type.fee_category_name
      %tr
        %th{scope: 'row'}
          = t('shared.summary.fee_type')
        %td
          = fee.fee_type.description

      - if fee.sub_type.present?
        %tr
          %th{scope: 'row'}
            = t('shared.summary.fee_subtype')
          %td
            = fee.sub_type.description
      - if fee.case_uplift?
        %tr
          %th{scope: 'row'}
            = t('shared.summary.case_numbers')
          %td
            = fee.case_numbers

      - if fee.claim.agfs? || fee.is_graduated? || fee.is_transfer?
        %tr
          %th{ scope: 'row'}
            - if fee.is_transfer? || fee.is_graduated?
              = "PPE"
            - else
              = t('shared.summary.quantity')
          %td
            = fee.quantity

      - if fee.claim.agfs?
        %tr
          %th{ scope: 'row'}
            = t('shared.summary.rate')
          %td
            = fee.rate
      %tr
        %th{ scope: 'row'}
          = t('shared.summary.amount')
        %td
          = fee.amount
      - if fee.dates_attended.any?
        %tr
          %th{scope: 'row'}
            = t('shared.summary.dates_attended')
          %td
            = fee.dates_attended_delimited_string
      - if fee.date?
        %tr
          %th{scope: 'row'}
            = t('shared.summary.date')
          %td
            = fee.date
  %tfoot
    %tr
      %th
        = t('shared.summary.fees_total')
      %td
        = claim.fees_total
