#defendants-section.form-section
  %h2.heading-large
    = t('external_users.claims.defendants.summary.header')
    - if local_assigns[:editable]
      = govuk_link_to t('.change'), edit_polymorphic_path(claim, step: :defendants, referrer: :summary), class: 'link-change', 'aria-label': t('.change_link_label')

  - defendant_fields_scope = 'external_users.claims.defendants.defendant_fields'
  - rep_order_fields_scope = 'external_users.claims.defendants.representation_order_fields'

  - if claim.defendants.empty?
    - if local_assigns.has_key?(:editable) && !local_assigns[:editable]
      = render partial: 'external_users/claims/summary/section_status', locals: { claim: claim, section: section, step: :defendants }
    - else
      %p
        = t('shared.summary.no_values.defendants')
  - else
    - claim.defendants.order(:created_at).each.with_index(1) do | defendant, index|

      - if claim.defendants.count > 1
        %h3.heading-medium
          = t('.common.defendant_index', index: index)

      %dl.govuk-summary-list
        .govuk-summary-list__row
          %dt.govuk-summary-list__key
            = t('first_name', scope: defendant_fields_scope)
          %dd.govuk-summary-list__value
            = defendant.first_name

        .govuk-summary-list__row
          %dt.govuk-summary-list__key
            = t('last_name', scope: defendant_fields_scope)
          %dd.govuk-summary-list__value
            = defendant.last_name

        - if defendant.date_of_birth.present?
          .govuk-summary-list__row
            %dt.govuk-summary-list__key
              = t('date_of_birth', scope: defendant_fields_scope)
            %dd.govuk-summary-list__value
              %time{ 'aria-label': defendant.date_of_birth.strftime(Settings.date_format_label), datetime: defendant.date_of_birth.strftime(Settings.datetime_attribute) }
                = defendant.date_of_birth.strftime(Settings.date_format)

        - unless claim.lgfs? && claim.interim?
          .govuk-summary-list__row
            %dt.govuk-summary-list__key
              = t('order_for_judicial_apportionment', scope: defendant_fields_scope)
            %dd.govuk-summary-list__value
              = defendant.order_for_judicial_apportionment == true ? t('.answer_yes') : t('.answer_no')

        - defendant.representation_orders.each.with_index(1) do | representation_order, index|
          .govuk-summary-list__row
            %dt.govuk-summary-list__key
              = t('date', scope: rep_order_fields_scope)
            %dd.govuk-summary-list__value
              %time{ 'aria-label': representation_order.representation_order_date.strftime(Settings.date_format_label), datetime: representation_order.representation_order_date.strftime(Settings.datetime_attribute) }
                = representation_order.representation_order_date.strftime(Settings.date_format)

          .govuk-summary-list__row
            %dt.govuk-summary-list__key
              = t('maat_reference_number', scope: rep_order_fields_scope)
            %dd.govuk-summary-list__value
              = representation_order.maat_reference
