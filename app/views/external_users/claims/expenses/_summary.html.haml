#expenses-section.form-section
  %h3.heading-medium
    = t('external_users.claims.expenses.summary.header')
    - if local_assigns[:editable]
      = link_to t('.change'), edit_polymorphic_path(claim, step: :travel_expenses, referrer: :summary), class: 'link-change', 'aria-label': t('.change_link_label')
  - if @claim.travel_expense_additional_information.present?
    .panel.panel-border-wide
      %h3.heading-small
        = t('.additional_information')
      %p
        = @claim.travel_expense_additional_information

  - if claim.expenses.empty?
    - if local_assigns.has_key?(:editable) && !local_assigns[:editable]
      = render partial: 'external_users/claims/summary/section_status', locals: { claim: claim, section: section, step: :travel_expenses }
    - else
      %p
        = t('shared.summary.no_values.expenses')
  - else
    %table{ class: 'summary', summary: t('.summary') }
      %caption
        %span.table-caption.visuallyhidden
          = t('.caption')
      %tbody
        - present_collection(claim.expenses).each.with_index(1) do |expense, index|
          %tr
            - if claim.expenses.length > 1
              %th{ class: 'bold' }
                = t('shared.summary.expense', index: index)
            %td{style: 'margin:0; padding: 0;'}
              %table.nested-summary
                %tbody
                  %tr
                    %th{ class: 'bold' }
                      = t('shared.summary.expense_type')
                    %td
                      = expense.name
                  %tr
                    %th{ class: 'bold' }
                      = t('shared.summary.reason')
                    %td
                      = expense.reason
                  - if expense.location.present?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.location')
                      %td
                        = expense.location
                  - if expense.distance.present?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.distance')
                      %td
                        = expense.distance
                  - if expense.date.present?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.date_of_expense')
                      %td
                        = expense.pretty_date
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.mileage_rate')
                      %td
                        = expense.mileage_rate
                  - if expense.quantity.present?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.quantity')
                      %td
                        = expense.quantity
                  - if expense.hours.present?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.quantity_hours')
                      %td
                        = expense.hours

                  - if expense.amount.present?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.amount')
                      %td
                        = expense.amount

                  - if claim.lgfs?
                    %tr
                      %th{ class: 'bold' }
                        = t('shared.summary.vat_amount')
                      %td
                        = expense.vat_amount
