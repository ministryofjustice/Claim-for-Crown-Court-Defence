-# NO Idea what this does
- @disable_logo_link  = true

- content_for?(:page_title) ? yield(:page_title) : contextual_title

- content_for :head do
  %meta{ name: 'format-detection', content: 'telephone=no' }

  = stylesheet_pack_tag 'application', media: 'all'

  - if GoogleAnalytics::DataTracking.enabled?
    = render partial: 'layouts/analytics', :formats => [:js], locals: { adapter: GoogleAnalytics::DataTracking.adapter_name }
    - if GoogleAnalytics::DataTracking.analytics?
      %script
        != ga_outlet

- content_for :body_classes do
  = "controller-" + controller.controller_name

- content_for :header_class do
  = "with-proposition"

- content_for :body_start do
  - if GoogleAnalytics::DataTracking.tag_manager?
    %noscript
      %iframe{ src: "https://www.googletagmanager.com/ns.html?id=#{ENV['GTM_TRACKED_ID']}", style: 'display:none;visibility:hidden', height: '0', width: '0' }

- content_for :proposition_header do
  .header-proposition
    .content
      - unless current_user.nil?
        = link_to 'Menu', '#proposition-links', class: 'js-header-toggle menu'

      %nav#proposition-menu
        %a#proposition-name{:href => "/"}
          %span.visuallyhidden
            = "Home link"
          = "Claim for crown court defence"

        - unless current_user.nil?
          = render partial: 'layouts/user'

- content_for(:default_navigation) do
  = render partial: 'layouts/primary_navigation'

= content_for :content do
  = csrf_meta_tags

  .site-wrapper
    = render partial: 'shared/phase_banner'

    %main#content
      - if user_signed_in?
        = content_for?(:navigation) ? yield(:navigation) : yield(:default_navigation)

      = render partial: 'layouts/flashes' unless flash.empty?
      = yield

      = render partial: 'layouts/contact_us_link'

- content_for :footer_support_links do
  = render partial: 'layouts/footer'

- content_for :body_end do
  = javascript_include_tag Rails.env.test? ? 'application.test' : 'application'
  - if GoogleAnalytics::DataTracking.analytics?
    :javascript
      ga(function(tracker) {
        var clientId = tracker.get('clientId');
        $('.ga-client-id').val(clientId);
      });


= render template: 'layouts/govuk_template'
