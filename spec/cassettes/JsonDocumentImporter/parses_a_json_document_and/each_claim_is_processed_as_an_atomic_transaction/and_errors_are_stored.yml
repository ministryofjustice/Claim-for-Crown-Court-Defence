---
http_interactions:
- request:
    method: post
    uri: http://localhost:3000/api/advocates/claims
    body:
      encoding: US-ASCII
      string: advocate_email=advocate%40example.com&case_number=12345678&case_type_id=1&indictment_number=12345678&first_day_of_trial=2015%2F06%2F01&estimated_trial_length=1&actual_trial_length=1&trial_concluded_at=2015%2F06%2F02&advocate_category=QC&prosecuting_authority=cps&offence_id=1&court_id=1&cms_number=12345678&additional_information=string&apply_vat=true&trial_fixed_notice_at=2015-06-01&trial_fixed_at=2015-06-01&trial_cracked_at=2015-06-01
    headers:
      Accept:
      - "*/*; q=0.5, application/xml"
      Accept-Encoding:
      - gzip, deflate
      Content-Length:
      - '438'
      Content-Type:
      - application/x-www-form-urlencoded
      User-Agent:
      - Ruby
  response:
    status:
      code: 201
      message: 'Created '
    headers:
      Content-Type:
      - application/json
      Content-Length:
      - '564'
      Etag:
      - '"e36b020882367fbebf3a74a840ff2a3c"'
      Cache-Control:
      - max-age=0, private, must-revalidate
      X-Request-Id:
      - c07d88d7-bad1-4764-a393-40b3cbfe29ff
      X-Runtime:
      - '0.049475'
      Server:
      - WEBrick/1.3.1 (Ruby/2.2.2/2015-04-13)
      Date:
      - Fri, 21 Aug 2015 16:29:15 GMT
      Connection:
      - Keep-Alive
    body:
      encoding: UTF-8
      string: '{"id":"54fec927-21dc-41e1-b60a-a54c390fb690","advocate_email":"advocate@example.com","case_number":"12345678","case_type_id":1,"indictment_number":"12345678","first_day_of_trial":"2015-06-01","estimated_trial_length":1,"actual_trial_length":1,"trial_concluded_at":"2015-06-02","advocate_category":"QC","prosecuting_authority":"cps","offence_id":1,"court_id":1,"cms_number":"12345678","additional_information":"string","apply_vat":true,"trial_fixed_notice_at":"2015-06-01","trial_fixed_at":"2015-06-01","trial_cracked_at":"2015-06-01","trial_cracked_at_third":null}'
    http_version: 
  recorded_at: Fri, 21 Aug 2015 16:29:15 GMT
- request:
    method: post
    uri: http://localhost:3000/api/advocates/defendants
    body:
      encoding: US-ASCII
      string: first_name=case&middle_name=management&last_name=system&date_of_birth=1979%2F12%2F10&order_for_judicial_apportionment=true&claim_id=54fec927-21dc-41e1-b60a-a54c390fb690
    headers:
      Accept:
      - "*/*; q=0.5, application/xml"
      Accept-Encoding:
      - gzip, deflate
      Content-Length:
      - '168'
      Content-Type:
      - application/x-www-form-urlencoded
      User-Agent:
      - Ruby
  response:
    status:
      code: 201
      message: 'Created '
    headers:
      Content-Type:
      - application/json
      Content-Length:
      - '251'
      Etag:
      - '"e0bad2fe3da76d14a2fe8876fbffc0b8"'
      Cache-Control:
      - max-age=0, private, must-revalidate
      X-Request-Id:
      - 8ab62121-b312-48b2-8667-d10784634815
      X-Runtime:
      - '0.021299'
      Server:
      - WEBrick/1.3.1 (Ruby/2.2.2/2015-04-13)
      Date:
      - Fri, 21 Aug 2015 16:29:15 GMT
      Connection:
      - Keep-Alive
    body:
      encoding: UTF-8
      string: '{"id":"456efcc8-0a41-4be2-a77e-f8501767945b","claim_id":"54fec927-21dc-41e1-b60a-a54c390fb690","first_name":"case","middle_name":"management","last_name":"system","date_of_birth":"1979-12-10T00:00:00.000+00:00","order_for_judicial_apportionment":true}'
    http_version: 
  recorded_at: Fri, 21 Aug 2015 16:29:15 GMT
- request:
    method: post
    uri: http://localhost:3000/api/advocates/representation_orders
    body:
      encoding: US-ASCII
      string: granting_body=Crown%20Court&maat_reference=12345678&representation_order_date=2015%2F05%2F01&defendant_id=456efcc8-0a41-4be2-a77e-f8501767945b
    headers:
      Accept:
      - "*/*; q=0.5, application/xml"
      Accept-Encoding:
      - gzip, deflate
      Content-Length:
      - '142'
      Content-Type:
      - application/x-www-form-urlencoded
      User-Agent:
      - Ruby
  response:
    status:
      code: 422
      message: ''
    headers:
      Content-Type:
      - text/plain; charset=utf-8
      X-Request-Id:
      - e14bb606-a4b3-4f0e-b5b9-580576f2a8cf
      X-Runtime:
      - '0.025061'
      Server:
      - WEBrick/1.3.1 (Ruby/2.2.2/2015-04-13)
      Date:
      - Fri, 21 Aug 2015 16:29:15 GMT
      Content-Length:
      - '6949'
      Connection:
      - Keep-Alive
    body:
      encoding: UTF-8
      string: "ActiveRecord::RecordInvalid at /api/advocates/representation_orders\n===================================================================\n\n>
        Validation failed: Maat reference has already been taken\n\napp/interfaces/api/v1/advocates/representation_order.rb,
        line 44\n----------------------------------------------------------------\n\n```
        ruby\n   39             params do\n   40               use :representation_order_creation\n
        \  41             end\n   42   \n   43             post do\n>  44               representation_order
        = ::RepresentationOrder.create!(args)\n   45               api_response =
        { 'id' => representation_order.reload.uuid }.merge!(declared(params))\n   46
        \              api_response\n   47             end\n   48   \n   49   \n```\n\nApp
        backtrace\n-------------\n\n - app/interfaces/api/v1/advocates/representation_order.rb:44:in
        `block (2 levels) in <class:RepresentationOrder>'\n\nFull backtrace\n--------------\n\n
        - activerecord (4.1.8) lib/active_record/validations.rb:57:in `save!'\n -
        activerecord (4.1.8) lib/active_record/attribute_methods/dirty.rb:29:in `save!'\n
        - activerecord (4.1.8) lib/active_record/transactions.rb:273:in `block in
        save!'\n - activerecord (4.1.8) lib/active_record/transactions.rb:329:in `block
        in with_transaction_returning_status'\n - activerecord (4.1.8) lib/active_record/connection_adapters/abstract/database_statements.rb:201:in
        `block in transaction'\n - activerecord (4.1.8) lib/active_record/connection_adapters/abstract/database_statements.rb:209:in
        `within_new_transaction'\n - activerecord (4.1.8) lib/active_record/connection_adapters/abstract/database_statements.rb:201:in
        `transaction'\n - activerecord (4.1.8) lib/active_record/transactions.rb:208:in
        `transaction'\n - activerecord (4.1.8) lib/active_record/transactions.rb:326:in
        `with_transaction_returning_status'\n - activerecord (4.1.8) lib/active_record/transactions.rb:273:in
        `save!'\n - activerecord (4.1.8) lib/active_record/validations.rb:41:in `create!'\n
        - app/interfaces/api/v1/advocates/representation_order.rb:44:in `block (2
        levels) in <class:RepresentationOrder>'\n - grape (0.12.0) lib/grape/endpoint.rb:47:in
        `block in generate_api_method'\n - grape (0.12.0) lib/grape/endpoint.rb:247:in
        `run'\n - grape (0.12.0) lib/grape/endpoint.rb:195:in `block in call!'\n -
        grape (0.12.0) lib/grape/middleware/base.rb:24:in `call!'\n - grape (0.12.0)
        lib/grape/middleware/base.rb:18:in `call'\n - grape (0.12.0) lib/grape/middleware/base.rb:24:in
        `call!'\n - grape (0.12.0) lib/grape/middleware/base.rb:18:in `call'\n - grape
        (0.12.0) lib/grape/middleware/base.rb:24:in `call!'\n - grape (0.12.0) lib/grape/middleware/base.rb:18:in
        `call'\n - grape (0.12.0) lib/grape/middleware/error.rb:27:in `block in call!'\n
        - grape (0.12.0) lib/grape/middleware/error.rb:26:in `call!'\n - grape (0.12.0)
        lib/grape/middleware/base.rb:18:in `call'\n - rack (1.5.5) lib/rack/head.rb:11:in
        `call'\n - rack (1.5.5) lib/rack/builder.rb:138:in `call'\n - grape (0.12.0)
        lib/grape/endpoint.rb:196:in `call!'\n - grape (0.12.0) lib/grape/endpoint.rb:184:in
        `call'\n - rack-mount (0.8.3) lib/rack/mount/route_set.rb:152:in `block in
        call'\n - rack-mount (0.8.3) lib/rack/mount/code_generation.rb:96:in `block
        in recognize'\n - rack-mount (0.8.3) lib/rack/mount/code_generation.rb:138:in
        `optimized_each'\n - rack-mount (0.8.3) lib/rack/mount/code_generation.rb:95:in
        `recognize'\n - rack-mount (0.8.3) lib/rack/mount/route_set.rb:141:in `call'\n
        - grape (0.12.0) lib/grape/api.rb:98:in `call'\n - grape (0.12.0) lib/grape/api.rb:33:in
        `call!'\n - grape (0.12.0) lib/grape/api.rb:29:in `call'\n - actionpack (4.1.8)
        lib/action_dispatch/journey/router.rb:73:in `block in call'\n - actionpack
        (4.1.8) lib/action_dispatch/journey/router.rb:59:in `call'\n - actionpack
        (4.1.8) lib/action_dispatch/routing/route_set.rb:678:in `call'\n - warden
        (1.2.3) lib/warden/manager.rb:35:in `block in call'\n - warden (1.2.3) lib/warden/manager.rb:34:in
        `call'\n - rack (1.5.5) lib/rack/etag.rb:23:in `call'\n - rack (1.5.5) lib/rack/conditionalget.rb:35:in
        `call'\n - rack (1.5.5) lib/rack/head.rb:11:in `call'\n - actionpack (4.1.8)
        lib/action_dispatch/middleware/params_parser.rb:27:in `call'\n - actionpack
        (4.1.8) lib/action_dispatch/middleware/flash.rb:254:in `call'\n - rack (1.5.5)
        lib/rack/session/abstract/id.rb:225:in `context'\n - rack (1.5.5) lib/rack/session/abstract/id.rb:220:in
        `call'\n - actionpack (4.1.8) lib/action_dispatch/middleware/cookies.rb:560:in
        `call'\n - activerecord (4.1.8) lib/active_record/query_cache.rb:36:in `call'\n
        - activerecord (4.1.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in
        `call'\n - activerecord (4.1.8) lib/active_record/migration.rb:380:in `call'\n
        - actionpack (4.1.8) lib/action_dispatch/middleware/callbacks.rb:29:in `block
        in call'\n - activesupport (4.1.8) lib/active_support/callbacks.rb:82:in `run_callbacks'\n
        - actionpack (4.1.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n
        - actionpack (4.1.8) lib/action_dispatch/middleware/reloader.rb:73:in `call'\n
        - actionpack (4.1.8) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'\n
        - better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'\n
        - better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'\n
        - better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'\n - actionpack
        (4.1.8) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'\n
        - actionpack (4.1.8) lib/action_dispatch/middleware/show_exceptions.rb:30:in
        `call'\n - railties (4.1.8) lib/rails/rack/logger.rb:38:in `call_app'\n -
        railties (4.1.8) lib/rails/rack/logger.rb:20:in `block in call'\n - activesupport
        (4.1.8) lib/active_support/tagged_logging.rb:68:in `block in tagged'\n - activesupport
        (4.1.8) lib/active_support/tagged_logging.rb:26:in `tagged'\n - activesupport
        (4.1.8) lib/active_support/tagged_logging.rb:68:in `tagged'\n - railties (4.1.8)
        lib/rails/rack/logger.rb:20:in `call'\n - quiet_assets (1.1.0) lib/quiet_assets.rb:27:in
        `call_with_quiet_assets'\n - request_store (1.2.0) lib/request_store/middleware.rb:8:in
        `call'\n - actionpack (4.1.8) lib/action_dispatch/middleware/request_id.rb:21:in
        `call'\n - rack (1.5.5) lib/rack/methodoverride.rb:21:in `call'\n - rack (1.5.5)
        lib/rack/runtime.rb:17:in `call'\n - activesupport (4.1.8) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in
        `call'\n - rack (1.5.5) lib/rack/lock.rb:17:in `call'\n - actionpack (4.1.8)
        lib/action_dispatch/middleware/static.rb:84:in `call'\n - rack (1.5.5) lib/rack/sendfile.rb:112:in
        `call'\n - railties (4.1.8) lib/rails/engine.rb:514:in `call'\n - railties
        (4.1.8) lib/rails/application.rb:144:in `call'\n - rack (1.5.5) lib/rack/lock.rb:17:in
        `call'\n - rack (1.5.5) lib/rack/content_length.rb:14:in `call'\n - rack (1.5.5)
        lib/rack/handler/webrick.rb:60:in `service'\n - webrick (1.3.1) lib/webrick/httpserver.rb:138:in
        `service'\n - webrick (1.3.1) lib/webrick/httpserver.rb:94:in `run'\n - webrick
        (1.3.1) lib/webrick/server.rb:191:in `block in start_thread'\n\n"
    http_version: 
  recorded_at: Fri, 21 Aug 2015 16:29:15 GMT
recorded_with: VCR 2.9.3
