!function(a){var b={sort:!1,"sort-attr":"data-priority","sort-desc":!1,autoselect:!0,"alternative-spellings":!0,"alternative-spellings-attr":"data-aliases","remove-valueless-options":!0,"copy-attributes-to-text-field":!0,"autocomplete-plugin":"jquery_ui","relevancy-sorting":!0,"relevancy-sorting-partial-match-value":1,"relevancy-sorting-strict-match-value":5,"relevancy-sorting-booster-attr":"data-weighting",minLength:0,delay:0,autoFocus:!0,handle_invalid_input:function(a){var b="option:selected:first";a.settings["remove-valueless-options"]&&(b='option:selected[value!=""]:first'),a.$text_field.val(a.$select_field.find(b).text())},handle_select_field:function(a){return a.hide()},insert_text_field:function(c){var d=a('<input type="text"></input>');if(b["copy-attributes-to-text-field"]){for(var e={},f=c.$select_field[0].attributes,g=0;g<f.length;g++){var h=f[g].nodeName,i=f[g].nodeValue;"name"!==h&&"id"!==h&&"undefined"!=typeof c.$select_field.attr(h)&&(e[h]=i)}d.attr(e)}d.blur(function(){var e=c.$select_field.find("option").map(function(b,c){return a(c).text()});a.inArray(d.val(),e)<0&&"function"==typeof b.handle_invalid_input&&b.handle_invalid_input(c)}),c.settings.autoselect&&d.click(function(){this.select()});var j="option:selected:first";return c.settings["remove-valueless-options"]&&(j='option:selected[value!=""]:first'),d.val(c.$select_field.find(j).text()).insertAfter(c.$select_field)},extract_options:function(c){var d=[],e=c.find("option"),f=e.length;return e.each(function(){var c=a(this),e={"real-value":c.attr("value"),label:c.text()};if(b["remove-valueless-options"]&&""===e["real-value"]);else{e.matches=e.label;var g=c.attr(b["alternative-spellings-attr"]);if(g&&(e.matches+=" "+g),b.sort){var h=parseInt(c.attr(b["sort-attr"]),10);h?e.weight=h:e.weight=f}if(b["relevancy-sorting"]){e["relevancy-score"]=0,e["relevancy-score-booster"]=1;var i=parseFloat(c.attr(b["relevancy-sorting-booster-attr"]));i&&(e["relevancy-score-booster"]=i)}d.push(e)}}),b.sort&&(b["sort-desc"]?d.sort(function(a,b){return b.weight-a.weight}):d.sort(function(a,b){return a.weight-b.weight})),d}},c={init:function(c){return/msie/.test(navigator.userAgent.toLowerCase())&&parseInt(navigator.appVersion,10)<=6?this:(b=a.extend(b,c),this.each(function(){var c=a(this),e={$select_field:c,options:b.extract_options(c),settings:b};e.$text_field=b.insert_text_field(e),b.handle_select_field(c),"string"==typeof b["autocomplete-plugin"]?d[b["autocomplete-plugin"]](e):b["autocomplete-plugin"](e)}))}},d={jquery_ui:function(b){var c=function(c){for(var d=c.split(" "),e=[],f=0;f<d.length;f++)if(d[f].length>0){var g={};g.partial=new RegExp(a.ui.autocomplete.escapeRegex(d[f]),"i"),b.settings["relevancy-sorting"]&&(g.strict=new RegExp("^"+a.ui.autocomplete.escapeRegex(d[f]),"i")),e.push(g)}return a.grep(b.options,function(a){var d=0;if(b.settings["relevancy-sorting"])var f=!1,g=a.matches.split(" ");for(var h=0;h<e.length;h++)if(e[h].partial.test(a.matches)&&d++,b.settings["relevancy-sorting"])for(var i=0;i<g.length;i++)if(e[h].strict.test(g[i])){f=!0;break}if(b.settings["relevancy-sorting"]){var j=0;j+=d*b.settings["relevancy-sorting-partial-match-value"],f&&(j+=b.settings["relevancy-sorting-strict-match-value"]),j*=a["relevancy-score-booster"],a["relevancy-score"]=j}return!c||e.length===d})},d=function(a){if(a)b.$select_field.val()!==a["real-value"]&&(b.$select_field.val(a["real-value"]),b.$select_field.change());else{for(var c=b.$text_field.val().toLowerCase(),d={"real-value":!1},e=0;e<b.options.length;e++)if(c===b.options[e].label.toLowerCase()){d=b.options[e];break}b.$select_field.val()!==d["real-value"]&&(b.$select_field.val(d["real-value"]||""),b.$select_field.change()),d["real-value"]&&b.$text_field.val(d.label),"function"==typeof b.settings.handle_invalid_input&&""===b.$select_field.val()&&b.settings.handle_invalid_input(b)}};b.$text_field.autocomplete({minLength:b.settings.minLength,delay:b.settings.delay,autoFocus:b.settings.autoFocus,source:function(a,d){var e=c(a.term);b.settings["relevancy-sorting"]&&(e=e.sort(function(a,b){return b["relevancy-score"]==a["relevancy-score"]?b.label<a.label?1:-1:b["relevancy-score"]-a["relevancy-score"]})),d(e)},select:function(a,b){d(b.item)},change:function(a,b){d(b.item)}}),b.$text_field.parents("form:first").submit(function(){d()}),d()}};a.fn.selectToAutocomplete=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.fn.selectToAutocomplete"):c.init.apply(this,arguments)}}(jQuery);